<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Advanced mapping | XData website </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Advanced mapping | XData website ">
    <meta name="generator" content="docfx 2.48.0.0">
    
    <link rel="shortcut icon" href="../.././images/cube.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../.././images/cube-white.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h2 id="advanced-mapping">Advanced mapping</h2>

<p>1) Let&#39;s write something really complicated! Let&#39;s start as usual with the preparation of the database. We already have the tables <em>t_catalog</em> and <em>t_doc_state</em>, we will create the rest and link them as shown in the diagram. </p>
<p>The fields deserve special mention:</p>
<ul>
<li>t_doc.generation - guid</li>
<li>t_doc_delivery.delivery_type - a short integer (we will store the enam value there)</li>
<li>t_doc_scan.scan - binary</li>
<li>t_doc_source.source - xml</li>
</ul>
<p>Dictionary <em>t_doc_type</em> must contain at least one entry with <em>code</em> = &quot;INVOICE&quot;</p>
<div class="lang-plantUml" \=""> <?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="418px" preserveaspectratio="none" style="width:489px;height:418px;" version="1.1" viewbox="0 0 489 418" width="489px" zoomandpan="magnify"><defs><filter height="300%" id="fredd2mwtv3hh" width="300%" x="-1" y="-1"><fegaussianblur result="blurOut" stddeviation="2.0"></fegaussianblur><fecolormatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></fecolormatrix><feoffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"></feoffset><feblend in="SourceGraphic" in2="blurOut3" mode="normal"></feblend></filter></defs><g><!--MD5=[4efa0cfa5e1d38a4afda4e219b98680a]
class t_doc_state--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="39.9688" id="t_doc_state" style="stroke: #000000; stroke-width: 1.0;" width="79" x="21.5" y="319"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="79" x="21.5" y="319"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="73" x="24.5" y="335.1387">t_doc_state</text><line style="stroke: #000000; stroke-width: 1.0;" x1="22.5" x2="99.5" y1="342.9688" y2="342.9688"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="22.5" x2="99.5" y1="350.9688" y2="350.9688"></line><!--MD5=[bccea5d0c54fc84e4bad16ab69fd73e7]
class t_doc_type--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="78.3828" id="t_doc_type" style="stroke: #000000; stroke-width: 1.0;" width="93.3333" x="385.5" y="300"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="93.3333" x="385.5" y="300"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="68" x="398.1667" y="316.1387">t_doc_type</text><line style="stroke: #000000; stroke-width: 1.5;" x1="386.5" x2="477.8333" y1="323.9688" y2="323.9688"></line><path d="M397.5417,330.6901 C396.2767,330.6901 395.25,331.7168 395.25,332.9818 C395.25,333.1284 395.2803,333.254 395.3078,333.3833 L392.5,336.191 L392.5,338.0244 L395.25,338.0244 L395.25,336.191 L397.0833,336.191 L397.0833,335.2744 L397.1411,335.2166 C397.2694,335.2441 397.395,335.2744 397.5426,335.2744 C398.8076,335.2744 399.8343,334.2477 399.8343,332.9827 C399.8343,331.7177 398.8076,330.691 397.5426,330.691 M398.0009,331.6077 C398.5051,331.6077 398.9176,332.0202 398.9176,332.5244 C398.9176,333.0285 398.5051,333.441 398.0009,333.441 C397.4968,333.441 397.0843,333.0285 397.0843,332.5244 C397.0843,332.0202 397.4968,331.6077 398.0009,331.6077 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="68" x="404.8333" y="338.1792">doc_type_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="386.5" x2="477.8333" y1="344.7734" y2="344.7734"></line><path d="M397.0833,352.4115 L394.3333,357.9115 L395.25,357.9115 L398,352.4115 L397.0833,352.4115 M393.4167,353.3281 L392.5,355.1615 L393.4167,356.9948 L394.3333,356.9948 L393.4167,355.1615 L394.3333,353.3281 L393.4167,353.3281 M398,353.3281 L398.9167,355.1615 L398,356.9948 L398.9167,356.9948 L399.8333,355.1615 L398.9167,353.3281 L398,353.3281 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="28" x="404.8333" y="358.9839">code</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="33" x="391.5" y="371.7886">name</text><!--MD5=[5ea577eca533bfca935d04f775d3f167]
class t_doc--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="137.6016" id="t_doc" style="stroke: #000000; stroke-width: 1.0;" width="97.3333" x="196.5" y="270"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="97.3333" x="196.5" y="270"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="34" x="228.1667" y="286.1387">t_doc</text><line style="stroke: #000000; stroke-width: 1.5;" x1="197.5" x2="292.8333" y1="293.9688" y2="293.9688"></line><path d="M208.5417,300.6901 C207.2767,300.6901 206.25,301.7168 206.25,302.9818 C206.25,303.1284 206.2803,303.254 206.3078,303.3833 L203.5,306.191 L203.5,308.0244 L206.25,308.0244 L206.25,306.191 L208.0833,306.191 L208.0833,305.2744 L208.1411,305.2166 C208.2694,305.2441 208.395,305.2744 208.5426,305.2744 C209.8076,305.2744 210.8343,304.2477 210.8343,302.9827 C210.8343,301.7177 209.8076,300.691 208.5426,300.691 M209.0009,301.6077 C209.5051,301.6077 209.9176,302.0202 209.9176,302.5244 C209.9176,303.0285 209.5051,303.441 209.0009,303.441 C208.4968,303.441 208.0843,303.0285 208.0843,302.5244 C208.0843,302.0202 208.4968,301.6077 209.0009,301.6077 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="36" x="215.8333" y="308.1792">doc_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="197.5" x2="292.8333" y1="314.7734" y2="314.7734"></line><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="52" x="202.5" y="328.9839">doc_date</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="32" x="202.5" y="341.7886">numb</text><path d="M207.1667,347.1042 C205.1408,347.1042 203.5,348.745 203.5,350.7708 C203.5,352.7967 205.1408,354.4375 207.1667,354.4375 C209.1925,354.4375 210.8333,352.7967 210.8333,350.7708 C210.8333,348.745 209.1925,347.1042 207.1667,347.1042 M207.1667,348.0208 L209.9167,350.7708 L207.1667,353.5208 L207.1667,351.6875 L204.4167,351.6875 L204.4167,349.8542 L207.1667,349.8542 L207.1667,348.0208 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="72" x="215.8333" y="354.5933">doc_state_id</text><path d="M207.1667,359.9089 C205.1408,359.9089 203.5,361.5497 203.5,363.5755 C203.5,365.6014 205.1408,367.2422 207.1667,367.2422 C209.1925,367.2422 210.8333,365.6014 210.8333,363.5755 C210.8333,361.5497 209.1925,359.9089 207.1667,359.9089 M207.1667,360.8255 L209.9167,363.5755 L207.1667,366.3255 L207.1667,364.4922 L204.4167,364.4922 L204.4167,362.6589 L207.1667,362.6589 L207.1667,360.8255 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="68" x="215.8333" y="367.3979">doc_type_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="197.5" x2="292.8333" y1="373.9922" y2="373.9922"></line><path d="M203.5,380.7135 L203.5,383.4635 L208.0833,388.0469 L210.8333,385.2969 L206.25,380.7135 L203.5,380.7135 M205.3333,381.6302 C205.8375,381.6302 206.25,382.0427 206.25,382.5469 C206.25,383.051 205.8375,383.4635 205.3333,383.4635 C204.8292,383.4635 204.4167,383.051 204.4167,382.5469 C204.4167,382.0427 204.8292,381.6302 205.3333,381.6302 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="63" x="215.8333" y="388.2026">generation</text><path d="M207.1667,393.5182 C205.1473,393.5182 203.5,395.1655 203.5,397.1849 C203.5,399.2043 205.1473,400.8516 207.1667,400.8516 C209.1861,400.8516 210.8333,399.2043 210.8333,397.1849 C210.8333,395.1655 209.1861,393.5182 207.1667,393.5182 M207.1667,394.4349 C208.6911,394.4349 209.9167,395.6605 209.9167,397.1849 C209.9167,398.7093 208.6911,399.9349 207.1667,399.9349 C205.6423,399.9349 204.4167,398.7093 204.4167,397.1849 C204.4167,395.6605 205.6423,394.4349 207.1667,394.4349 M206.7083,395.3516 L206.7083,397.3856 L206.8513,397.5002 L207.3097,397.9586 L207.625,398.3023 L208.2841,397.6432 L207.9403,397.3279 L207.625,397.0126 L207.625,395.3506 L206.7083,395.3506 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="49" x="215.8333" y="401.0073">changed</text><!--MD5=[eab5c40043b4b5329be06de2f0271aac]
class t_catalog_doc--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="65.5781" id="t_catalog_doc" style="stroke: #000000; stroke-width: 1.0;" width="95.6667" x="6" y="126"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="95.6667" x="6" y="126"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="87" x="10.3333" y="142.1387">t_catalog_doc</text><line style="stroke: #000000; stroke-width: 1.0;" x1="7" x2="100.6667" y1="149.9688" y2="149.9688"></line><path d="M18.0417,156.6901 C16.7767,156.6901 15.75,157.7168 15.75,158.9818 C15.75,159.1284 15.7802,159.254 15.8078,159.3833 L13,162.191 L13,164.0244 L15.75,164.0244 L15.75,162.191 L17.5833,162.191 L17.5833,161.2744 L17.6411,161.2166 C17.7694,161.2441 17.895,161.2744 18.0426,161.2744 C19.3076,161.2744 20.3342,160.2477 20.3342,158.9827 C20.3342,157.7177 19.3076,156.691 18.0426,156.691 M18.5009,157.6077 C19.0051,157.6077 19.4176,158.0202 19.4176,158.5244 C19.4176,159.0285 19.0051,159.441 18.5009,159.441 C17.9968,159.441 17.5843,159.0285 17.5843,158.5244 C17.5843,158.0202 17.9968,157.6077 18.5009,157.6077 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="0" x="25.3333" y="164.1792"></text><path d="M30,156.6901 C27.9742,156.6901 26.3333,158.3309 26.3333,160.3568 C26.3333,162.3826 27.9742,164.0234 30,164.0234 C32.0258,164.0234 33.6667,162.3826 33.6667,160.3568 C33.6667,158.3309 32.0258,156.6901 30,156.6901 M30,157.6068 L32.75,160.3568 L30,163.1068 L30,161.2734 L27.25,161.2734 L27.25,159.4401 L30,159.4401 L30,157.6068 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="57" x="38.6667" y="164.1792">catalog_id</text><path d="M18.0417,169.4948 C16.7767,169.4948 15.75,170.5215 15.75,171.7865 C15.75,171.9331 15.7802,172.0587 15.8078,172.188 L13,174.9957 L13,176.829 L15.75,176.829 L15.75,174.9957 L17.5833,174.9957 L17.5833,174.079 L17.6411,174.0213 C17.7694,174.0488 17.895,174.079 18.0426,174.079 C19.3076,174.079 20.3342,173.0524 20.3342,171.7874 C20.3342,170.5224 19.3076,169.4957 18.0426,169.4957 M18.5009,170.4124 C19.0051,170.4124 19.4176,170.8249 19.4176,171.329 C19.4176,171.8332 19.0051,172.2457 18.5009,172.2457 C17.9968,172.2457 17.5843,171.8332 17.5843,171.329 C17.5843,170.8249 17.9968,170.4124 18.5009,170.4124 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="0" x="25.3333" y="176.9839"></text><path d="M30,169.4948 C27.9742,169.4948 26.3333,171.1356 26.3333,173.1615 C26.3333,175.1873 27.9742,176.8281 30,176.8281 C32.0258,176.8281 33.6667,175.1873 33.6667,173.1615 C33.6667,171.1356 32.0258,169.4948 30,169.4948 M30,170.4115 L32.75,173.1615 L30,175.9115 L30,174.0781 L27.25,174.0781 L27.25,172.2448 L30,172.2448 L30,170.4115 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="36" x="38.6667" y="176.9839">doc_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="7" x2="100.6667" y1="183.5781" y2="183.5781"></line><!--MD5=[957235e470c5a75c0bcb7e32f4b6bfa6]
class t_catalog--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="39.9688" id="t_catalog" style="stroke: #000000; stroke-width: 1.0;" width="64" x="22" y="8"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="64" x="22" y="8"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="58" x="25" y="24.1387">t_catalog</text><line style="stroke: #000000; stroke-width: 1.0;" x1="23" x2="85" y1="31.9688" y2="31.9688"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="23" x2="85" y1="39.9688" y2="39.9688"></line><!--MD5=[fd8c5e68644f1f4fc0b14eca97226ae4]
class t_doc_delivery--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="78.3828" id="t_doc_delivery" style="stroke: #000000; stroke-width: 1.0;" width="95" x="137.5" y="120"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="95" x="137.5" y="120"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="89" x="140.5" y="136.1387">t_doc_delivery</text><line style="stroke: #000000; stroke-width: 1.5;" x1="138.5" x2="231.5" y1="143.9688" y2="143.9688"></line><path d="M149.5417,150.6901 C148.2767,150.6901 147.25,151.7168 147.25,152.9818 C147.25,153.1284 147.2803,153.254 147.3078,153.3833 L144.5,156.191 L144.5,158.0244 L147.25,158.0244 L147.25,156.191 L149.0833,156.191 L149.0833,155.2744 L149.1411,155.2166 C149.2694,155.2441 149.395,155.2744 149.5426,155.2744 C150.8076,155.2744 151.8343,154.2477 151.8343,152.9827 C151.8343,151.7177 150.8076,150.691 149.5426,150.691 M150.0009,151.6077 C150.5051,151.6077 150.9176,152.0202 150.9176,152.5244 C150.9176,153.0285 150.5051,153.441 150.0009,153.441 C149.4968,153.441 149.0843,153.0285 149.0843,152.5244 C149.0843,152.0202 149.4968,151.6077 150.0009,151.6077 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="0" x="156.8333" y="158.1792"></text><path d="M161.5,150.6901 C159.4742,150.6901 157.8333,152.3309 157.8333,154.3568 C157.8333,156.3826 159.4742,158.0234 161.5,158.0234 C163.5258,158.0234 165.1667,156.3826 165.1667,154.3568 C165.1667,152.3309 163.5258,150.6901 161.5,150.6901 M161.5,151.6068 L164.25,154.3568 L161.5,157.1068 L161.5,155.2734 L158.75,155.2734 L158.75,153.4401 L161.5,153.4401 L161.5,151.6068 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="36" x="170.1667" y="158.1792">doc_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="138.5" x2="231.5" y1="164.7734" y2="164.7734"></line><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="80" x="143.5" y="178.9839">delivery_type</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="80" x="143.5" y="191.7886">delivery_date</text><!--MD5=[710d3dc0240fd500b1d510e138be1447]
class t_doc_scan--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="65.5781" id="t_doc_scan" style="stroke: #000000; stroke-width: 1.0;" width="75" x="267.5" y="126"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="75" x="267.5" y="126"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="69" x="270.5" y="142.1387">t_doc_scan</text><line style="stroke: #000000; stroke-width: 1.5;" x1="268.5" x2="341.5" y1="149.9688" y2="149.9688"></line><path d="M279.5417,156.6901 C278.2767,156.6901 277.25,157.7168 277.25,158.9818 C277.25,159.1284 277.2803,159.254 277.3078,159.3833 L274.5,162.191 L274.5,164.0244 L277.25,164.0244 L277.25,162.191 L279.0833,162.191 L279.0833,161.2744 L279.1411,161.2166 C279.2694,161.2441 279.395,161.2744 279.5426,161.2744 C280.8076,161.2744 281.8343,160.2477 281.8343,158.9827 C281.8343,157.7177 280.8076,156.691 279.5426,156.691 M280.0009,157.6077 C280.5051,157.6077 280.9176,158.0202 280.9176,158.5244 C280.9176,159.0285 280.5051,159.441 280.0009,159.441 C279.4968,159.441 279.0843,159.0285 279.0843,158.5244 C279.0843,158.0202 279.4968,157.6077 280.0009,157.6077 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="0" x="286.8333" y="164.1792"></text><path d="M291.5,156.6901 C289.4742,156.6901 287.8333,158.3309 287.8333,160.3568 C287.8333,162.3826 289.4742,164.0234 291.5,164.0234 C293.5258,164.0234 295.1667,162.3826 295.1667,160.3568 C295.1667,158.3309 293.5258,156.6901 291.5,156.6901 M291.5,157.6068 L294.25,160.3568 L291.5,163.1068 L291.5,161.2734 L288.75,161.2734 L288.75,159.4401 L291.5,159.4401 L291.5,157.6068 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="36" x="300.1667" y="164.1792">doc_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="268.5" x2="341.5" y1="170.7734" y2="170.7734"></line><path d="M274.5,177.4948 L274.5,184.8281 L281.8333,184.8281 L281.8333,182.651 A0.4583,0.4583 0 0 0 281.8333,182.4503 L281.8333,177.4948 L274.5,177.4948 M275.4167,178.4115 L280.9167,178.4115 L280.9167,182.0781 L279.5417,182.0781 A0.4583,0.4583 0 0 0 279.4555,182.0781 A0.4602,0.4602 0 1 0 279.5417,182.9948 L280.9167,182.9948 L280.9167,183.9115 L275.4167,183.9115 L275.4167,178.4115 M277.7083,179.3281 C276.9475,179.3281 276.3333,179.9423 276.3333,180.7031 C276.3333,181.6198 277.7083,182.9948 277.7083,182.9948 C277.7083,182.9948 279.0833,181.6198 279.0833,180.7031 C279.0833,179.9423 278.4692,179.3281 277.7083,179.3281 M277.7083,180.2448 C277.965,180.2448 278.1667,180.4465 278.1667,180.7031 C278.1667,180.9598 277.965,181.1615 277.7083,181.1615 C277.4517,181.1615 277.25,180.9598 277.25,180.7031 C277.25,180.4465 277.4517,180.2448 277.7083,180.2448 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="27" x="286.8333" y="184.9839">scan</text><!--MD5=[5937349b424f6b33ad58af94594dfd63]
class t_doc_source--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="65.5781" id="t_doc_source" style="stroke: #000000; stroke-width: 1.0;" width="88" x="378" y="126"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="88" x="378" y="126"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="82" x="381" y="142.1387">t_doc_source</text><line style="stroke: #000000; stroke-width: 1.5;" x1="379" x2="465" y1="149.9688" y2="149.9688"></line><path d="M390.0417,156.6901 C388.7767,156.6901 387.75,157.7168 387.75,158.9818 C387.75,159.1284 387.7803,159.254 387.8078,159.3833 L385,162.191 L385,164.0244 L387.75,164.0244 L387.75,162.191 L389.5833,162.191 L389.5833,161.2744 L389.6411,161.2166 C389.7694,161.2441 389.895,161.2744 390.0426,161.2744 C391.3076,161.2744 392.3343,160.2477 392.3343,158.9827 C392.3343,157.7177 391.3076,156.691 390.0426,156.691 M390.5009,157.6077 C391.0051,157.6077 391.4176,158.0202 391.4176,158.5244 C391.4176,159.0285 391.0051,159.441 390.5009,159.441 C389.9968,159.441 389.5843,159.0285 389.5843,158.5244 C389.5843,158.0202 389.9968,157.6077 390.5009,157.6077 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="0" x="397.3333" y="164.1792"></text><path d="M402,156.6901 C399.9742,156.6901 398.3333,158.3309 398.3333,160.3568 C398.3333,162.3826 399.9742,164.0234 402,164.0234 C404.0258,164.0234 405.6667,162.3826 405.6667,160.3568 C405.6667,158.3309 404.0258,156.6901 402,156.6901 M402,157.6068 L404.75,160.3568 L402,163.1068 L402,161.2734 L399.25,161.2734 L399.25,159.4401 L402,159.4401 L402,157.6068 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="36" x="410.6667" y="164.1792">doc_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="379" x2="465" y1="170.7734" y2="170.7734"></line><path d="M385,177.4948 L385,184.8281 L391.4167,184.8281 L391.4167,181.1615 L387.75,181.1615 L387.75,177.4948 L385,177.4948 M388.6667,177.4948 L388.6667,180.2448 L391.4167,180.2448 L388.6667,177.4948 M385.9167,179.3281 L386.8333,179.3281 L386.8333,180.2448 L385.9167,180.2448 L385.9167,179.3281 M385.9167,181.1615 L386.8333,181.1615 L386.8333,182.0781 L385.9167,182.0781 L385.9167,181.1615 M385.9167,182.9948 L389.5833,182.9948 L389.5833,183.9115 L385.9167,183.9115 L385.9167,182.9948 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="40" x="397.3333" y="184.9839">source</text><!--MD5=[8feb3003cd59a4822a76af3887dc1c0a]
link t_doc_state to t_doc--><path d="M100.9253,339 C126.418,339 159.865,339 188.115,339 " fill="none" id="t_doc_state-&gt;t_doc" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="188.316" x2="196.316" y1="339" y2="331"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="188.316" x2="196.316" y1="339" y2="347"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="188.316" x2="196.316" y1="339" y2="339"></line><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="59" x="119" y="332.4258">doc_state_id</text><!--MD5=[691dc1cbb8fa0f09f9906b607bf3ccef]
reverse link t_doc to t_doc_type--><path d="M301.764,339 C328.461,339 359.908,339 385.213,339 " fill="none" id="t_doc&lt;-t_doc_type" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="301.644" x2="293.644" y1="339" y2="347"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="301.644" x2="293.644" y1="339" y2="331"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="301.644" x2="293.644" y1="339" y2="339"></line><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="55" x="312" y="332.4258">doc_type_id</text><!--MD5=[cc073f3f803e6be11274258daf9be266]
reverse link t_catalog to t_catalog_doc--><path d="M54,56.25 C54,76.59 54,104.449 54,125.874 " fill="none" id="t_catalog&lt;-t_catalog_doc" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="54" x2="46" y1="56.034" y2="48.034"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="54" x2="62" y1="56.034" y2="48.034"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="54" x2="54" y1="56.034" y2="48.034"></line><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="49" x="55" y="86.4258">catalog_id</text><!--MD5=[64363e4c077e3ece99a0e625ba56e6a8]
link t_catalog_doc to t_doc--><path d="M88.5887,192.234 C116.925,218.643 157.542,256.495 190.284,287.008 " fill="none" id="t_catalog_doc-&gt;t_doc" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="190.449" x2="196.301" y1="287.1602" y2="286.763"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="190.449" x2="196.301" y1="287.1602" y2="298.467"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="190.449" x2="196.301" y1="287.1602" y2="292.615"></line><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="30" x="140" y="236.4258">doc_id</text><!--MD5=[94de7abaa940d64e718a7c3244926e87]
reverse link t_doc_delivery to t_doc--><path d="M200.502,205.988 C207.043,225.394 214.795,248.391 221.981,269.709 " fill="none" id="t_doc_delivery&lt;-t_doc" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="200.428" x2="192.1865" y1="205.7657" y2="200.102"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="200.428" x2="203.5575" y1="205.7657" y2="196.268"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="200.428" x2="197.872" y1="205.7657" y2="198.185"></line><ellipse cx="202.3449" cy="211.4512" fill="none" rx="4" ry="4" style="stroke: #000000; stroke-width: 1.0;"></ellipse><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="30" x="213" y="236.4258">doc_id</text><!--MD5=[7c459e52799c0d4d655e72449bb91e72]
reverse link t_doc_scan to t_doc--><path d="M291.561,199.869 C284.612,220.484 275.937,246.22 267.964,269.872 " fill="none" id="t_doc_scan&lt;-t_doc" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="291.578" x2="288.4485" y1="199.8147" y2="190.317"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="291.578" x2="299.8195" y1="199.8147" y2="194.151"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="291.578" x2="294.134" y1="199.8147" y2="192.234"></line><ellipse cx="289.6611" cy="205.5002" fill="none" rx="4" ry="4" style="stroke: #000000; stroke-width: 1.0;"></ellipse><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="30" x="281" y="236.4258">doc_id</text><!--MD5=[4aa29f824d631e9db9c0b4ff518403cc]
reverse link t_doc_source to t_doc--><path d="M384.103,198.111 C357.627,224.736 322.052,260.512 293.507,289.219 " fill="none" id="t_doc_source&lt;-t_doc" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="384.3059" x2="385.6926" y1="197.9065" y2="188.0032"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="384.3059" x2="394.2014" y1="197.9065" y2="196.4648"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="384.3059" x2="389.947" y1="197.9065" y2="192.234"></line><ellipse cx="380.075" cy="202.161" fill="none" rx="4" ry="4" style="stroke: #000000; stroke-width: 1.0;"></ellipse><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="30" x="350" y="236.4258">doc_id</text><!--MD5=[d6bc4b6cc2a149cbe8bd0e47eff7d1f1]
@startuml


hide circle
skinparam ClassHeaderBackgroundColor lightgray
skinparam ClassBorderColor black
skinparam ClassBorderThickness 1
skinparam ClassBackgroundColor transparrent
skinparam ArrowFontSize 8
skinparam ArrowColor black

entity t_doc_state
{
}

entity t_doc_type
{
   <&key> doc_type_id
   - -
   <&code> code
   name
}

entity t_doc
{
   <&key> doc_id
   - -
   doc_date
   numb
   <&arrow-circle-right> doc_state_id
   <&arrow-circle-right> doc_type_id
   - -
   <&tag> generation
   <&clock> changed
}
t_doc_state -right-{ t_doc : doc_state_id
t_doc_type -left-{ t_doc : doc_type_id

entity t_catalog_doc
{
   <&key> <&arrow-circle-right> catalog_id
   <&key> <&arrow-circle-right> doc_id
}
t_catalog_doc -up-{ t_catalog : catalog_id
t_catalog_doc - -{ t_doc : doc_id

entity t_doc_delivery
{
   <&key> <&arrow-circle-right> doc_id
   - -
   delivery_type
   delivery_date
}
t_doc_delivery }o- - t_doc : doc_id

entity t_doc_scan
{
   <&key> <&arrow-circle-right> doc_id
   - -
   <&map> scan
}
t_doc_scan }o- - t_doc : doc_id

entity t_doc_source
{
   <&key> <&arrow-circle-right> doc_id
   - -
   <&document> source
}
t_doc_source }o- - t_doc : doc_id
@enduml

PlantUML version 1.2020.09beta15(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 14.0.1+7
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg> </div><p>2) Add <em>Model</em> class <em>Invoice.cs</em> in a <em>Models</em> folder...</p>
<pre><code class="lang-csharp">public enum DeliveryTypeEnum
{
    [Display(Description = &quot;PickUp&quot;)]
    PickUp,
    [Display(Description = &quot;Courier&quot;)]
    Courier,
    [Display(Description = &quot;Mail&quot;)]
    Mail
}

public partial class Invoice
{
    public long DocId =&gt; this.GetProperty(x =&gt; x.DocId);
    public string DocStateCode =&gt; this.GetProperty(x =&gt; x.DocStateCode);
    public Link&lt;string, DocState&gt; DocState { get; set; }
    public long DocCatalogId { get; set; }
    public string Numb { get; set; }
    public DateTime? DocDate { get; set; }
    public Guid Generation =&gt; this.GetProperty(x =&gt; x.Generation);
    public DateTime Changed =&gt; this.GetProperty(x =&gt; x.Changed);
    public Lob Scan { get; set; }
    public Xml Source { get; set; }
    public DeliveryTypeEnum DeliveryType { get; set; }
    public DateTime DeliveryDate { get; set; }
}
</code></pre><p>3) Add class <em>Invoice.xdata.cs</em> in a <em>Models</em> folder and define mapping...</p>
<pre><code class="lang-csharp">public partial class Invoice: IDataObject
{
    private static Expression&lt;CustomMapping&lt;Invoice&gt;&gt; _ = (
        () =&gt; XDataMapping.CustomMapping&lt;Invoice&gt;()
            .DataTable(&quot;T_DOC&quot;, &quot;D&quot;, 
                x =&gt; x.DictFilter(&quot;T_DOC_TYPE&quot;, &quot;doc_type_id&quot;, &quot;code&quot;, &quot;INVOICE&quot;))
            .DataTable(&quot;T_DOC_STATE&quot;, &quot;S&quot;, x =&gt; x.Link(&quot;D&quot;, &quot;doc_state_id&quot;))
            .DataTable(&quot;T_DOC_CATALOG&quot;, &quot;DC&quot;, &quot;D&quot;, x =&gt; x.Link(&quot;D&quot;, &quot;doc_id&quot;))
            .DataTable(&quot;T_DOC_SCAN&quot;, &quot;SC&quot;, &quot;D&quot;, x =&gt; x.Link(&quot;D&quot;, &quot;doc_id&quot;)
                .SetOperation(FilterOperation.OuterJoin))
            .DataTable(&quot;T_DOC_SOURCE&quot;, &quot;SR&quot;, &quot;D&quot;, x =&gt; x.Link(&quot;D&quot;, &quot;doc_id&quot;)
                .SetOperation(FilterOperation.OuterJoin))
            .DataTable(&quot;T_DOC_DELIVERY&quot;, &quot;DD&quot;, &quot;D&quot;, x =&gt; x.Link(&quot;D&quot;, &quot;doc_id&quot;))
            .ReadOnlyProperty(x =&gt; x.DocId, x =&gt; x.Field&lt;long&gt;(&quot;D&quot;, string.Empty, 
                z =&gt; z.Key(), 
                z =&gt; z.Default(DefaultType.AutoIncrement)))
            .Column(&quot;DocStateId&quot;, x =&gt; x.Field&lt;long&gt;(&quot;S&quot;, string.Empty))
            .ReadOnlyProperty(x =&gt; x.DocStateCode, x =&gt; x.Field&lt;string&gt;(&quot;S&quot;, &quot;code&quot;))
            .ReadOnlyProperty(x =&gt; x.Generation, x =&gt; x.Field&lt;Guid&gt;(&quot;D&quot;, string.Empty, 
                z =&gt; z.ConcurrencyToken(), z =&gt; z.Default(DefaultType.NewGuid)))
            .ReadOnlyProperty(x =&gt; x.Changed, x =&gt; x.Field&lt;DateTime&gt;(&quot;D&quot;, string.Empty, 
                z =&gt; z.Default(DefaultType.CurrentDateTime, DefaultFeature.UseOnUpdate)))
            .Map(x =&gt; new Invoice {
                DocCatalogId =&gt; x.Field&lt;long&gt;(&quot;DC&quot;, &quot;catalog_id&quot;),
                DocState = x.Link&lt;string, DocState&gt;(&quot;S&quot;, &quot;name&quot;,
                    z =&gt; z.LinkProperty&lt;DocState&gt;(y =&gt; y.Name),
                    z =&gt; z.LinkProperty&lt;DocState&gt;((Invoice y) =&gt; y.DocStateId),
                    z =&gt; z.LinkProperty&lt;DocState&gt;(y =&gt; y.Code, y =&gt; y.DocStateCode)),
                Numb = x.Field&lt;string&gt;(&quot;D&quot;, string.Empty),
                DocDate = x.Field&lt;DateTime?&gt;(&quot;D&quot;, string.Empty, 
                    z =&gt; z.Default(DefaultType.CurrentDate)),
                Scan = x.Lob(&quot;SC&quot;, z =&gt; z.OuterFlag()),
                Source = x.Xml(&quot;SR&quot;, z =&gt; z.OuterFlag()),
                DeliveryType = x.Field&lt;DeliveryTypeEnum&gt;(&quot;DD&quot;, string.Empty),
                DeliveryDate = x.Field&lt;DateTime&gt;(&quot;DD&quot;, string.Empty, 
                    z =&gt; z.Default(DefaultType.CurrentDate))
            }).SetBaseTable(&quot;D&quot;)
    );
}
</code></pre><p>4) The first unfamiliar thing for us is <a class="xref" href="../../api/XData.Mapping.Dynamic.IInnerFilterAdapter.html#XData_Mapping_Dynamic_IInnerFilterAdapter_DictFilter_System_String_System_String_System_String_System_String_">DictFilter</a>. This method allows you to filter the data object by reference to the dictionary in which there is a unique string field <em>Code</em> with which we can not rely on the dictionary identifiers at the level of mapping and business logic. In fact, it degenerates into a filter on a subquery (in our case it will be <em>D.doc_type_id = (select doc_type_id from T_DOC_TYPE where code = &#39;INVOICE&#39;)</em>). See <a href="../../tutorial/mapping/dynamic/dynamic.html#dictionary-filters">documentation topic</a> for more details</p>
<p>5) A not very noticeable, but extremely important detail is that for some tables a new overload of the <a class="xref" href="../../api/XData.Mapping.Dynamic.IRepositoryStructure-1.html#XData_Mapping_Dynamic_IRepositoryStructure_1_DataTable_System_String_System_String_System_String_System_Linq_Expressions_Expression_System_Func_XData_Mapping_Dynamic_IInnerFilterAdapter_XData_Mapping_Dynamic_IFilterDescription_____">DataTable</a> method is used with the <em>parent</em> parameter, which defines the alias of the parent table in <a href="../../tutorial/glossary.html#updatable-tables-hierarchy">updatable tables hierarchy</a>. The introduction of this concept allows applying the change not to one table, but to any number of tables in which information about an instance of a data object is stored.</p>
<div class="IMPORTANT"><h5>Important</h5><p>Do not forget to specify the parent table in the <em>updatable table tree</em> for those tables that should be updated when the data object changes. At the same time, tables containing reference information are not included in the <em>updatable table tree</em> and do not participate in the update process. For such tables, an overload of the <em>DataTable</em> method is used, which we used earlier.</p>
</div>
<p>6) The next interesting thing is the <a class="xref" href="../../api/XData.Mapping.Dynamic.IRepositoryReadOnlyPropertyMappingAdapter.html#XData_Mapping_Dynamic_IRepositoryReadOnlyPropertyMappingAdapter_ConcurrencyToken">ConcurrencyToken</a> modifier, which is responsible for <a href="https://en.wikipedia.org/wiki/Optimistic_concurrency_control">optimistic lock</a> support. This modifier works in tandem with the familiar <em>Default</em> modifier, which is initialized with the <a class="xref" href="../../api/XData.DefaultType.html">DefaultType.NewGuid</a> value, which means generating a new unique key (GUID). See <a href="../../tutorial/mapping/dynamic/dynamic.html#properties">documentation topic</a> for more details</p>
<div class="TIP"><h5>Tip</h5><p>Note that the competition token is described in mapping and does not require any other code! It can even be mapped into a read-only field (as in this case).</p>
</div>
<p>7) The next interesting detail is the automatic completion of the <em>Changed</em> property by change date. Using the <em>Default</em> modifier with two parameters, the first <a class="xref" href="../../api/XData.DefaultType.html">DefaultType.CurrentDateTime</a> sets the mechanism for obtaining the default field value by storing the date and time of the change in the local time zone, and the second <a class="xref" href="../../api/XData.DefaultFeature.html">DefaultFeature.UseOnUpdate</a> allows you to save the change time not only during insertion but also during update. See <a href="../../tips/default_features.html">documentation topic</a> for more details</p>
<p>8) The <em>DocDate</em> and <em>DeliveryDate</em> properties are modified with the default value <a class="xref" href="../../api/XData.DefaultType.html">DefaultType.CurrentDate</a> which means that by default, the current date will be written to these properties.</p>
<p>9) The <em>Scan</em> property has a specific type of <a class="xref" href="../../api/XData.Mapping.Lob.html">Lob</a> and its mapping is described using the <a class="xref" href="../../api/XData.Mapping.Dynamic.IRepositoryStructureAdapter-1.html#XData_Mapping_Dynamic_IRepositoryStructureAdapter_1_Lob_System_String_System_Linq_Expressions_Expression_System_Func_XData_Mapping_Dynamic_IRepositoryReadOnlyPropertyMappingAdapter_XData_Mapping_Dynamic_IStructureFlag_____">Lob</a> method. Similarly, the <em>Source</em> property has a specific <a class="xref" href="../../api/XData.Mapping.Xml.html">Xml</a> type and its mapping is described using the <a class="xref" href="../../api/XData.Mapping.Dynamic.IRepositoryStructureAdapter-1.html#XData_Mapping_Dynamic_IRepositoryStructureAdapter_1_Xml_System_String_System_Linq_Expressions_Expression_System_Func_XData_Mapping_Dynamic_IRepositoryReadOnlyPropertyMappingAdapter_XData_Mapping_Dynamic_IStructureFlag_____">Xml</a> method. The work with these types is different, but it is important that by default the value of such fields is loaded only if the value of a large object is immediately addressed. There are also features when serializing them in JSON (we will consider this below). There are also features when serializing them in JSON (we will consider this below). This behavior allows you to significantly accelerate the work with objects that contain information in large fields. See documentation topic about <a href="../../tutorial/mapping/mapping.html#bynary-properties">bynary properties</a> and <a href="../../tutorial/mapping/mapping.html#xml-properties">Xml properties</a> for more details</p>
<p>10) Web API controller for this object will look like...</p>
<pre><code class="lang-csharp">using XData;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Mvc;
using &lt;..Youre namespace..&gt;.Models;

namespace &lt;..Youre namespace..&gt;.Controllers.API
{
    public class InvoiceController : DataObjectController&lt;Invoice&gt;
    {
        public InvoiceController(IDataEngine dataEngine) : base(dataEngine) { }

        [HttpGet]
        public async Task&lt;ActionResult&lt;Invoice&gt;&gt; Get(long id)
        {
            try
            {
                using (var dataScope = _dataEngine.NewDataScope())
                {
                    return await dataScope.GetRepository&lt;Invoice&gt;()
                        .SingleOrDefaultAsync(x =&gt; x.DocId == id);
                }
            }
            catch (Exception e)
            {
                e.FillModelState(ModelState);
                throw;
            }
        }

        [HttpGet]
        public async Task&lt;ActionResult&lt;Invoice[]&gt;&gt; GetByCatalog(long id)
        {
            try
            {
                using (var dataScope = _dataEngine.NewDataScope())
                {
                    return await dataScope.GetRepository&lt;Invoice&gt;()
                        .ToArrayAsync(x =&gt; x.CatalogId == id);
                }
            }
            catch (Exception e)
            {
                e.FillModelState(ModelState);
                throw;
            }
        }

        [HttpGet]
        public async Task&lt;ActionResult&lt;Invoice&gt;&gt; Export(long id)
        {
            try
            {
                using (var dataScope = _dataEngine.NewDataScope())
                {
                    return await dataScope.GetRepository&lt;Invoice&gt;()
                        .SingleOrDefaultAsync(x =&gt; x.DocId == id,
                            x =&gt; x.LoadLob());
                }
            }
            catch (Exception e)
            {
                e.FillModelState(ModelState);
                throw;
            }
        }

        [HttpGet]
        public async Task&lt;ActionResult&lt;byte[]&gt;&gt; GetScan(long id)
        {
            try
            {
                using (var dataScope = _dataEngine.NewDataScope())
                {
                    return await dataScope.GetRepository&lt;Invoice&gt;()
                        .Where(x =&gt; x.DocId == id)
                        .Scan.Value;
                }
            }
            catch (Exception e)
            {
                e.FillModelState(ModelState);
                throw;
            }
        }

        [HttpPut]
        public async Task&lt;ActionResult&lt;Invoice[]&gt;&gt; FindBySource([FromBody]string xpath, string value)
        {
            try
            {
                using (var dataScope = _dataEngine.NewDataScope())
                {
                    return await dataScope.GetRepository&lt;Invoice&gt;()
                        .Where(x =&gt; x.Source.Extract(xpath) == value)
                        .ToArrayAsync();
                }
            }
            catch (Exception e)
            {
                e.FillModelState(ModelState);
                throw;
            }
        }
    }
}
</code></pre><p>11) The <em>Export</em> method shows how you can get an object with large fields filled. This is available due to the use of the <a class="xref" href="../../api/XData.Json.JsonSettings-1.html#XData_Json_JsonSettings_1_LoadLob">LoadLob</a> modifier. Most asynchronous XData methods have overloads to describe serialization parameters. For a complete description, refer to the corresponding <a href="../../tips/json.html">documentation article</a>.</p>
<p>12) Getting the value of a binary object is shown in the <em>GetScan</em> method. To get the value, use the <a class="xref" href="../../api/XData.Mapping.Lob.html#XData_Mapping_Lob_Value">Value</a> property of the <em>Lob</em> object.</p>
<p>13) The <em>Xml</em> type is interesting, among other things, because its contents can be used to construct XPath queries and use them to filter data. To do this, use the <a class="xref" href="../../api/XData.Mapping.Xml.html#XData_Mapping_Xml_Extract_System_String_System_Collections_Generic_KeyValuePair_System_String_System_String____">Extract</a> method of type <em>Xml</em> as shown in the <em>FindBySource</em> method.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/mickfierte/private/blob/main/doc/quick_start/asp_net_core/mapping_three.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
