<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Advanced mapping | XData website </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Advanced mapping | XData website ">
    <meta name="generator" content="docfx 2.48.0.0">
    
    <link rel="shortcut icon" href="../.././images/cube.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../.././images/cube-white.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h2 id="advanced-mapping">Advanced mapping</h2>

<p>1) Let&#39;s write something really complicated! Let&#39;s start as usual with the preparation of the database. We already have the tables <em>t_catalog</em> and <em>t_doc_state</em>, we will create the rest and link them as shown in the diagram. </p>
<p>The fields deserve special mention:</p>
<ul>
<li>t_doc.generation - guid</li>
<li>t_doc_delivery.delivery_type - a short integer (we will store the enam value there)</li>
<li>t_doc_scan.scan - binary</li>
<li>t_doc_source.source - xml</li>
</ul>
<p>Dictionary <em>t_doc_type</em> must contain at least one entry with <em>code</em> = &quot;INVOICE&quot;</p>
<div class="lang-plantUml" \=""> <?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="416px" preserveaspectratio="none" style="width:479px;height:416px;" version="1.1" viewbox="0 0 479 416" width="479px" zoomandpan="magnify"><defs><filter height="300%" id="fredd2mwtv3hh" width="300%" x="-1" y="-1"><fegaussianblur result="blurOut" stddeviation="2.0"></fegaussianblur><fecolormatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"></fecolormatrix><feoffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"></feoffset><feblend in="SourceGraphic" in2="blurOut3" mode="normal"></feblend></filter></defs><g><!--MD5=[4efa0cfa5e1d38a4afda4e219b98680a]
class t_doc_state--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="39.9688" id="t_doc_state" style="stroke: #000000; stroke-width: 1.0;" width="75" x="34.5" y="317"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="75" x="34.5" y="317"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="69" x="37.5" y="333.1387">t_doc_state</text><line style="stroke: #000000; stroke-width: 1.0;" x1="35.5" x2="108.5" y1="340.9688" y2="340.9688"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="35.5" x2="108.5" y1="348.9688" y2="348.9688"></line><!--MD5=[bccea5d0c54fc84e4bad16ab69fd73e7]
class t_doc_type--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="78.3828" id="t_doc_type" style="stroke: #000000; stroke-width: 1.0;" width="93.3333" x="375.5" y="298"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="93.3333" x="375.5" y="298"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="66" x="389.1667" y="314.1387">t_doc_type</text><line style="stroke: #000000; stroke-width: 1.5;" x1="376.5" x2="467.8333" y1="321.9688" y2="321.9688"></line><path d="M387.5417,328.6901 C386.2767,328.6901 385.25,329.7168 385.25,330.9818 C385.25,331.1284 385.2803,331.254 385.3078,331.3833 L382.5,334.191 L382.5,336.0244 L385.25,336.0244 L385.25,334.191 L387.0833,334.191 L387.0833,333.2744 L387.1411,333.2166 C387.2694,333.2441 387.395,333.2744 387.5426,333.2744 C388.8076,333.2744 389.8343,332.2477 389.8343,330.9827 C389.8343,329.7177 388.8076,328.691 387.5426,328.691 M388.0009,329.6077 C388.5051,329.6077 388.9176,330.0202 388.9176,330.5244 C388.9176,331.0285 388.5051,331.441 388.0009,331.441 C387.4968,331.441 387.0843,331.0285 387.0843,330.5244 C387.0843,330.0202 387.4968,329.6077 388.0009,329.6077 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="68" x="394.8333" y="336.1792">doc_type_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="376.5" x2="467.8333" y1="342.7734" y2="342.7734"></line><path d="M387.0833,350.4115 L384.3333,355.9115 L385.25,355.9115 L388,350.4115 L387.0833,350.4115 M383.4167,351.3281 L382.5,353.1615 L383.4167,354.9948 L384.3333,354.9948 L383.4167,353.1615 L384.3333,351.3281 L383.4167,351.3281 M388,351.3281 L388.9167,353.1615 L388,354.9948 L388.9167,354.9948 L389.8333,353.1615 L388.9167,351.3281 L388,351.3281 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="28" x="394.8333" y="356.9839">code</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="33" x="381.5" y="369.7886">name</text><!--MD5=[5ea577eca533bfca935d04f775d3f167]
class t_doc--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="137.6016" id="t_doc" style="stroke: #000000; stroke-width: 1.0;" width="96.3333" x="196" y="268"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="96.3333" x="196" y="268"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="33" x="227.6667" y="284.1387">t_doc</text><line style="stroke: #000000; stroke-width: 1.5;" x1="197" x2="291.3333" y1="291.9688" y2="291.9688"></line><path d="M208.0417,298.6901 C206.7767,298.6901 205.75,299.7168 205.75,300.9818 C205.75,301.1284 205.7803,301.254 205.8078,301.3833 L203,304.191 L203,306.0244 L205.75,306.0244 L205.75,304.191 L207.5833,304.191 L207.5833,303.2744 L207.6411,303.2166 C207.7694,303.2441 207.895,303.2744 208.0426,303.2744 C209.3076,303.2744 210.3343,302.2477 210.3343,300.9827 C210.3343,299.7177 209.3076,298.691 208.0426,298.691 M208.5009,299.6077 C209.0051,299.6077 209.4176,300.0202 209.4176,300.5244 C209.4176,301.0285 209.0051,301.441 208.5009,301.441 C207.9968,301.441 207.5843,301.0285 207.5843,300.5244 C207.5843,300.0202 207.9968,299.6077 208.5009,299.6077 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="36" x="215.3333" y="306.1792">doc_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="197" x2="291.3333" y1="312.7734" y2="312.7734"></line><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="52" x="202" y="326.9839">doc_date</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="32" x="202" y="339.7886">numb</text><path d="M206.6667,345.1042 C204.6408,345.1042 203,346.745 203,348.7708 C203,350.7967 204.6408,352.4375 206.6667,352.4375 C208.6925,352.4375 210.3333,350.7967 210.3333,348.7708 C210.3333,346.745 208.6925,345.1042 206.6667,345.1042 M206.6667,346.0208 L209.4167,348.7708 L206.6667,351.5208 L206.6667,349.6875 L203.9167,349.6875 L203.9167,347.8542 L206.6667,347.8542 L206.6667,346.0208 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="71" x="215.3333" y="352.5933">doc_state_id</text><path d="M206.6667,357.9089 C204.6408,357.9089 203,359.5497 203,361.5755 C203,363.6014 204.6408,365.2422 206.6667,365.2422 C208.6925,365.2422 210.3333,363.6014 210.3333,361.5755 C210.3333,359.5497 208.6925,357.9089 206.6667,357.9089 M206.6667,358.8255 L209.4167,361.5755 L206.6667,364.3255 L206.6667,362.4922 L203.9167,362.4922 L203.9167,360.6589 L206.6667,360.6589 L206.6667,358.8255 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="68" x="215.3333" y="365.3979">doc_type_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="197" x2="291.3333" y1="371.9922" y2="371.9922"></line><path d="M203,378.7135 L203,381.4635 L207.5833,386.0469 L210.3333,383.2969 L205.75,378.7135 L203,378.7135 M204.8333,379.6302 C205.3375,379.6302 205.75,380.0427 205.75,380.5469 C205.75,381.051 205.3375,381.4635 204.8333,381.4635 C204.3292,381.4635 203.9167,381.051 203.9167,380.5469 C203.9167,380.0427 204.3292,379.6302 204.8333,379.6302 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="62" x="215.3333" y="386.2026">generation</text><path d="M206.6667,391.5182 C204.6473,391.5182 203,393.1655 203,395.1849 C203,397.2043 204.6473,398.8516 206.6667,398.8516 C208.6861,398.8516 210.3333,397.2043 210.3333,395.1849 C210.3333,393.1655 208.6861,391.5182 206.6667,391.5182 M206.6667,392.4349 C208.1911,392.4349 209.4167,393.6605 209.4167,395.1849 C209.4167,396.7093 208.1911,397.9349 206.6667,397.9349 C205.1423,397.9349 203.9167,396.7093 203.9167,395.1849 C203.9167,393.6605 205.1423,392.4349 206.6667,392.4349 M206.2083,393.3516 L206.2083,395.3856 L206.3513,395.5002 L206.8097,395.9586 L207.125,396.3023 L207.7841,395.6432 L207.4403,395.3279 L207.125,395.0126 L207.125,393.3506 L206.2083,393.3506 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="49" x="215.3333" y="399.0073">changed</text><!--MD5=[eab5c40043b4b5329be06de2f0271aac]
class t_catalog_doc--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="65.5781" id="t_catalog_doc" style="stroke: #000000; stroke-width: 1.0;" width="95.6667" x="6" y="124"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="95.6667" x="6" y="124"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="83" x="12.3333" y="140.1387">t_catalog_doc</text><line style="stroke: #000000; stroke-width: 1.0;" x1="7" x2="100.6667" y1="147.9688" y2="147.9688"></line><path d="M18.0417,154.6901 C16.7767,154.6901 15.75,155.7168 15.75,156.9818 C15.75,157.1284 15.7802,157.254 15.8078,157.3833 L13,160.191 L13,162.0244 L15.75,162.0244 L15.75,160.191 L17.5833,160.191 L17.5833,159.2744 L17.6411,159.2166 C17.7694,159.2441 17.895,159.2744 18.0426,159.2744 C19.3076,159.2744 20.3342,158.2477 20.3342,156.9827 C20.3342,155.7177 19.3076,154.691 18.0426,154.691 M18.5009,155.6077 C19.0051,155.6077 19.4176,156.0202 19.4176,156.5244 C19.4176,157.0285 19.0051,157.441 18.5009,157.441 C17.9968,157.441 17.5843,157.0285 17.5843,156.5244 C17.5843,156.0202 17.9968,155.6077 18.5009,155.6077 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="0" x="25.3333" y="162.1792"></text><path d="M30,154.6901 C27.9742,154.6901 26.3333,156.3309 26.3333,158.3568 C26.3333,160.3826 27.9742,162.0234 30,162.0234 C32.0258,162.0234 33.6667,160.3826 33.6667,158.3568 C33.6667,156.3309 32.0258,154.6901 30,154.6901 M30,155.6068 L32.75,158.3568 L30,161.1068 L30,159.2734 L27.25,159.2734 L27.25,157.4401 L30,157.4401 L30,155.6068 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="57" x="38.6667" y="162.1792">catalog_id</text><path d="M18.0417,167.4948 C16.7767,167.4948 15.75,168.5215 15.75,169.7865 C15.75,169.9331 15.7802,170.0587 15.8078,170.188 L13,172.9957 L13,174.829 L15.75,174.829 L15.75,172.9957 L17.5833,172.9957 L17.5833,172.079 L17.6411,172.0213 C17.7694,172.0488 17.895,172.079 18.0426,172.079 C19.3076,172.079 20.3342,171.0524 20.3342,169.7874 C20.3342,168.5224 19.3076,167.4957 18.0426,167.4957 M18.5009,168.4124 C19.0051,168.4124 19.4176,168.8249 19.4176,169.329 C19.4176,169.8332 19.0051,170.2457 18.5009,170.2457 C17.9968,170.2457 17.5843,169.8332 17.5843,169.329 C17.5843,168.8249 17.9968,168.4124 18.5009,168.4124 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="0" x="25.3333" y="174.9839"></text><path d="M30,167.4948 C27.9742,167.4948 26.3333,169.1356 26.3333,171.1615 C26.3333,173.1873 27.9742,174.8281 30,174.8281 C32.0258,174.8281 33.6667,173.1873 33.6667,171.1615 C33.6667,169.1356 32.0258,167.4948 30,167.4948 M30,168.4115 L32.75,171.1615 L30,173.9115 L30,172.0781 L27.25,172.0781 L27.25,170.2448 L30,170.2448 L30,168.4115 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="36" x="38.6667" y="174.9839">doc_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="7" x2="100.6667" y1="181.5781" y2="181.5781"></line><!--MD5=[957235e470c5a75c0bcb7e32f4b6bfa6]
class t_catalog--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="39.9688" id="t_catalog" style="stroke: #000000; stroke-width: 1.0;" width="60" x="24" y="6"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="60" x="24" y="6"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="54" x="27" y="22.1387">t_catalog</text><line style="stroke: #000000; stroke-width: 1.0;" x1="25" x2="83" y1="29.9688" y2="29.9688"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="25" x2="83" y1="37.9688" y2="37.9688"></line><!--MD5=[fd8c5e68644f1f4fc0b14eca97226ae4]
class t_doc_delivery--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="78.3828" id="t_doc_delivery" style="stroke: #000000; stroke-width: 1.0;" width="94" x="137" y="118"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="94" x="137" y="118"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="88" x="140" y="134.1387">t_doc_delivery</text><line style="stroke: #000000; stroke-width: 1.5;" x1="138" x2="230" y1="141.9688" y2="141.9688"></line><path d="M149.0417,148.6901 C147.7767,148.6901 146.75,149.7168 146.75,150.9818 C146.75,151.1284 146.7803,151.254 146.8078,151.3833 L144,154.191 L144,156.0244 L146.75,156.0244 L146.75,154.191 L148.5833,154.191 L148.5833,153.2744 L148.6411,153.2166 C148.7694,153.2441 148.895,153.2744 149.0426,153.2744 C150.3076,153.2744 151.3343,152.2477 151.3343,150.9827 C151.3343,149.7177 150.3076,148.691 149.0426,148.691 M149.5009,149.6077 C150.0051,149.6077 150.4176,150.0202 150.4176,150.5244 C150.4176,151.0285 150.0051,151.441 149.5009,151.441 C148.9968,151.441 148.5843,151.0285 148.5843,150.5244 C148.5843,150.0202 148.9968,149.6077 149.5009,149.6077 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="0" x="156.3333" y="156.1792"></text><path d="M161,148.6901 C158.9742,148.6901 157.3333,150.3309 157.3333,152.3568 C157.3333,154.3826 158.9742,156.0234 161,156.0234 C163.0258,156.0234 164.6667,154.3826 164.6667,152.3568 C164.6667,150.3309 163.0258,148.6901 161,148.6901 M161,149.6068 L163.75,152.3568 L161,155.1068 L161,153.2734 L158.25,153.2734 L158.25,151.4401 L161,151.4401 L161,149.6068 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="36" x="169.6667" y="156.1792">doc_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="138" x2="230" y1="162.7734" y2="162.7734"></line><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="79" x="143" y="176.9839">delivery_type</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="79" x="143" y="189.7886">delivery_date</text><!--MD5=[710d3dc0240fd500b1d510e138be1447]
class t_doc_scan--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="65.5781" id="t_doc_scan" style="stroke: #000000; stroke-width: 1.0;" width="74.6667" x="266.5" y="124"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="74.6667" x="266.5" y="124"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="67" x="270.3333" y="140.1387">t_doc_scan</text><line style="stroke: #000000; stroke-width: 1.5;" x1="267.5" x2="340.1667" y1="147.9688" y2="147.9688"></line><path d="M278.5417,154.6901 C277.2767,154.6901 276.25,155.7168 276.25,156.9818 C276.25,157.1284 276.2803,157.254 276.3078,157.3833 L273.5,160.191 L273.5,162.0244 L276.25,162.0244 L276.25,160.191 L278.0833,160.191 L278.0833,159.2744 L278.1411,159.2166 C278.2694,159.2441 278.395,159.2744 278.5426,159.2744 C279.8076,159.2744 280.8343,158.2477 280.8343,156.9827 C280.8343,155.7177 279.8076,154.691 278.5426,154.691 M279.0009,155.6077 C279.5051,155.6077 279.9176,156.0202 279.9176,156.5244 C279.9176,157.0285 279.5051,157.441 279.0009,157.441 C278.4968,157.441 278.0843,157.0285 278.0843,156.5244 C278.0843,156.0202 278.4968,155.6077 279.0009,155.6077 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="0" x="285.8333" y="162.1792"></text><path d="M290.5,154.6901 C288.4742,154.6901 286.8333,156.3309 286.8333,158.3568 C286.8333,160.3826 288.4742,162.0234 290.5,162.0234 C292.5258,162.0234 294.1667,160.3826 294.1667,158.3568 C294.1667,156.3309 292.5258,154.6901 290.5,154.6901 M290.5,155.6068 L293.25,158.3568 L290.5,161.1068 L290.5,159.2734 L287.75,159.2734 L287.75,157.4401 L290.5,157.4401 L290.5,155.6068 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="36" x="299.1667" y="162.1792">doc_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="267.5" x2="340.1667" y1="168.7734" y2="168.7734"></line><path d="M273.5,175.4948 L273.5,182.8281 L280.8333,182.8281 L280.8333,180.651 A0.4583,0.4583 0 0 0 280.8333,180.4503 L280.8333,175.4948 L273.5,175.4948 M274.4167,176.4115 L279.9167,176.4115 L279.9167,180.0781 L278.5417,180.0781 A0.4583,0.4583 0 0 0 278.4555,180.0781 A0.4602,0.4602 0 1 0 278.5417,180.9948 L279.9167,180.9948 L279.9167,181.9115 L274.4167,181.9115 L274.4167,176.4115 M276.7083,177.3281 C275.9475,177.3281 275.3333,177.9423 275.3333,178.7031 C275.3333,179.6198 276.7083,180.9948 276.7083,180.9948 C276.7083,180.9948 278.0833,179.6198 278.0833,178.7031 C278.0833,177.9423 277.4692,177.3281 276.7083,177.3281 M276.7083,178.2448 C276.965,178.2448 277.1667,178.4465 277.1667,178.7031 C277.1667,178.9598 276.965,179.1615 276.7083,179.1615 C276.4517,179.1615 276.25,178.9598 276.25,178.7031 C276.25,178.4465 276.4517,178.2448 276.7083,178.2448 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="26" x="285.8333" y="182.9839">scan</text><!--MD5=[5937349b424f6b33ad58af94594dfd63]
class t_doc_source--><rect fill="#FFFFFF" filter="url(#fredd2mwtv3hh)" height="65.5781" id="t_doc_source" style="stroke: #000000; stroke-width: 1.0;" width="87" x="376.5" y="124"></rect><rect fill="#D3D3D3" height="23.9688" style="stroke: #000000; stroke-width: 1.0;" width="87" x="376.5" y="124"></rect><text fill="#000000" font-family="sans-serif" font-size="12" lengthadjust="spacingAndGlyphs" textlength="81" x="379.5" y="140.1387">t_doc_source</text><line style="stroke: #000000; stroke-width: 1.5;" x1="377.5" x2="462.5" y1="147.9688" y2="147.9688"></line><path d="M388.5417,154.6901 C387.2767,154.6901 386.25,155.7168 386.25,156.9818 C386.25,157.1284 386.2803,157.254 386.3078,157.3833 L383.5,160.191 L383.5,162.0244 L386.25,162.0244 L386.25,160.191 L388.0833,160.191 L388.0833,159.2744 L388.1411,159.2166 C388.2694,159.2441 388.395,159.2744 388.5426,159.2744 C389.8076,159.2744 390.8343,158.2477 390.8343,156.9827 C390.8343,155.7177 389.8076,154.691 388.5426,154.691 M389.0009,155.6077 C389.5051,155.6077 389.9176,156.0202 389.9176,156.5244 C389.9176,157.0285 389.5051,157.441 389.0009,157.441 C388.4968,157.441 388.0843,157.0285 388.0843,156.5244 C388.0843,156.0202 388.4968,155.6077 389.0009,155.6077 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="0" x="395.8333" y="162.1792"></text><path d="M400.5,154.6901 C398.4742,154.6901 396.8333,156.3309 396.8333,158.3568 C396.8333,160.3826 398.4742,162.0234 400.5,162.0234 C402.5258,162.0234 404.1667,160.3826 404.1667,158.3568 C404.1667,156.3309 402.5258,154.6901 400.5,154.6901 M400.5,155.6068 L403.25,158.3568 L400.5,161.1068 L400.5,159.2734 L397.75,159.2734 L397.75,157.4401 L400.5,157.4401 L400.5,155.6068 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="36" x="409.1667" y="162.1792">doc_id</text><line style="stroke: #000000; stroke-width: 1.0;" x1="377.5" x2="462.5" y1="168.7734" y2="168.7734"></line><path d="M383.5,175.4948 L383.5,182.8281 L389.9167,182.8281 L389.9167,179.1615 L386.25,179.1615 L386.25,175.4948 L383.5,175.4948 M387.1667,175.4948 L387.1667,178.2448 L389.9167,178.2448 L387.1667,175.4948 M384.4167,177.3281 L385.3333,177.3281 L385.3333,178.2448 L384.4167,178.2448 L384.4167,177.3281 M384.4167,179.1615 L385.3333,179.1615 L385.3333,180.0781 L384.4167,180.0781 L384.4167,179.1615 M384.4167,180.9948 L388.0833,180.9948 L388.0833,181.9115 L384.4167,181.9115 L384.4167,180.9948 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"></path><text fill="#000000" font-family="sans-serif" font-size="11" lengthadjust="spacingAndGlyphs" textlength="38" x="395.8333" y="182.9839">source</text><!--MD5=[8feb3003cd59a4822a76af3887dc1c0a]
link t_doc_state to t_doc--><path d="M109.746,337 C132.589,337 162.148,337 187.713,337 " fill="none" id="t_doc_state-&gt;t_doc" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="187.86" x2="195.86" y1="337" y2="329"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="187.86" x2="195.86" y1="337" y2="345"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="187.86" x2="195.86" y1="337" y2="337"></line><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="50" x="127.75" y="330.4258">doc_state_id</text><!--MD5=[691dc1cbb8fa0f09f9906b607bf3ccef]
reverse link t_doc to t_doc_type--><path d="M300.212,337 C324.39,337 352.32,337 375.33,337 " fill="none" id="t_doc&lt;-t_doc_type" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="300.169" x2="292.169" y1="337" y2="345"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="300.169" x2="292.169" y1="337" y2="329"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="300.169" x2="292.169" y1="337" y2="337"></line><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="47" x="310.25" y="330.4258">doc_type_id</text><!--MD5=[cc073f3f803e6be11274258daf9be266]
reverse link t_catalog to t_catalog_doc--><path d="M54,54.25 C54,74.59 54,102.449 54,123.874 " fill="none" id="t_catalog&lt;-t_catalog_doc" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="54" x2="46" y1="54.034" y2="46.034"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="54" x2="62" y1="54.034" y2="46.034"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="54" x2="54" y1="54.034" y2="46.034"></line><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="42" x="55" y="84.4258">catalog_id</text><!--MD5=[64363e4c077e3ece99a0e625ba56e6a8]
link t_catalog_doc to t_doc--><path d="M88.4076,190.234 C116.697,216.737 157.289,254.765 189.919,285.334 " fill="none" id="t_catalog_doc-&gt;t_doc" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="190.0759" x2="195.914" y1="285.4814" y2="285.1129"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="190.0759" x2="195.914" y1="285.4814" y2="296.7891"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="190.0759" x2="195.914" y1="285.4814" y2="290.951"></line><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="25" x="139" y="234.4258">doc_id</text><!--MD5=[94de7abaa940d64e718a7c3244926e87]
reverse link t_doc_delivery to t_doc--><path d="M199.502,203.988 C206.043,223.394 213.795,246.391 220.981,267.709 " fill="none" id="t_doc_delivery&lt;-t_doc" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="199.428" x2="191.1865" y1="203.7657" y2="198.102"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="199.428" x2="202.5575" y1="203.7657" y2="194.268"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="199.428" x2="196.872" y1="203.7657" y2="196.185"></line><ellipse cx="201.3449" cy="209.4512" fill="none" rx="4" ry="4" style="stroke: #000000; stroke-width: 1.0;"></ellipse><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="25" x="212" y="234.4258">doc_id</text><!--MD5=[7c459e52799c0d4d655e72449bb91e72]
reverse link t_doc_scan to t_doc--><path d="M290.561,197.869 C283.612,218.484 274.937,244.22 266.964,267.872 " fill="none" id="t_doc_scan&lt;-t_doc" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="290.578" x2="287.4485" y1="197.8147" y2="188.317"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="290.578" x2="298.8195" y1="197.8147" y2="192.151"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="290.578" x2="293.134" y1="197.8147" y2="190.234"></line><ellipse cx="288.6611" cy="203.5002" fill="none" rx="4" ry="4" style="stroke: #000000; stroke-width: 1.0;"></ellipse><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="25" x="280" y="234.4258">doc_id</text><!--MD5=[4aa29f824d631e9db9c0b4ff518403cc]
reverse link t_doc_source to t_doc--><path d="M382.317,196.111 C355.991,222.736 320.617,258.512 292.233,287.219 " fill="none" id="t_doc_source&lt;-t_doc" style="stroke: #000000; stroke-width: 1.0;"></path><line style="stroke: #000000; stroke-width: 1.0;" x1="382.5034" x2="383.8613" y1="195.9229" y2="186.0155"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="382.5034" x2="392.3947" y1="195.9229" y2="194.4525"></line><line style="stroke: #000000; stroke-width: 1.0;" x1="382.5034" x2="388.128" y1="195.9229" y2="190.234"></line><ellipse cx="378.2849" cy="200.1896" fill="none" rx="4" ry="4" style="stroke: #000000; stroke-width: 1.0;"></ellipse><text fill="#000000" font-family="sans-serif" font-size="8" lengthadjust="spacingAndGlyphs" textlength="25" x="348" y="234.4258">doc_id</text><!--MD5=[e5289b989f20ef9db91ec766c5f49285]
@startuml


hide circle
skinparam ClassHeaderBackgroundColor lightgray
skinparam ClassBorderColor black
skinparam ClassBorderThickness 1
skinparam ClassBackgroundColor transparrent
skinparam ArrowFontSize 8
skinparam ArrowColor black

entity t_doc_state
{
}

entity t_doc_type
{
   <&key> doc_type_id
   - -
   <&code> code
   name
}

entity t_doc
{
   <&key> doc_id
   - -
   doc_date
   numb
   <&arrow-circle-right> doc_state_id
   <&arrow-circle-right> doc_type_id
   - -
   <&tag> generation
   <&clock> changed
}
t_doc_state -right-{ t_doc : doc_state_id
t_doc_type -left-{ t_doc : doc_type_id

entity t_catalog_doc
{
   <&key> <&arrow-circle-right> catalog_id
   <&key> <&arrow-circle-right> doc_id
}
t_catalog_doc -up-{ t_catalog : catalog_id
t_catalog_doc - -{ t_doc : doc_id

entity t_doc_delivery
{
   <&key> <&arrow-circle-right> doc_id
   - -
   delivery_type
   delivery_date
}
t_doc_delivery }o- - t_doc : doc_id

entity t_doc_scan
{
   <&key> <&arrow-circle-right> doc_id
   - -
   <&map> scan
}
t_doc_scan }o- - t_doc : doc_id

entity t_doc_source
{
   <&key> <&arrow-circle-right> doc_id
   - -
   <&document> source
}
t_doc_source }o- - t_doc : doc_id
@enduml

PlantUML version 1.2020.12(Sat Jun 06 10:54:15 UTC 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg> </div><p>2) Add <em>Model</em> class <em>Invoice.cs</em> in a <em>Models</em> folder...</p>
<pre><code class="lang-csharp">public enum DeliveryTypeEnum
{
    [Display(Description = &quot;PickUp&quot;)]
    PickUp,
    [Display(Description = &quot;Courier&quot;)]
    Courier,
    [Display(Description = &quot;Mail&quot;)]
    Mail
}

public partial class Invoice
{
    public long DocId =&gt; this.GetProperty(x =&gt; x.DocId);
    public string DocStateCode =&gt; this.GetProperty(x =&gt; x.DocStateCode);
    public Link&lt;string, DocState&gt; DocState { get; set; }
    public long DocCatalogId { get; set; }
    public string Numb { get; set; }
    public DateTime? DocDate { get; set; }
    public Guid Generation =&gt; this.GetProperty(x =&gt; x.Generation);
    public DateTime Changed =&gt; this.GetProperty(x =&gt; x.Changed);
    public Lob Scan { get; set; }
    public Xml Source { get; set; }
    public DeliveryTypeEnum DeliveryType { get; set; }
    public DateTime DeliveryDate { get; set; }
}
</code></pre><p>3) Add class <em>Invoice.xdata.cs</em> in a <em>Models</em> folder and define mapping...</p>
<pre><code class="lang-csharp">public partial class Invoice: IDataObject
{
    private static Expression&lt;CustomMapping&lt;Invoice&gt;&gt; _ = (
        () =&gt; XDataMapping.CustomMapping&lt;Invoice&gt;()
            .DataTable(&quot;T_DOC&quot;, &quot;D&quot;, 
                x =&gt; x.DictFilter(&quot;T_DOC_TYPE&quot;, &quot;doc_type_id&quot;, &quot;code&quot;, &quot;INVOICE&quot;))
            .DataTable(&quot;T_DOC_STATE&quot;, &quot;S&quot;, x =&gt; x.Link(&quot;D&quot;, &quot;doc_state_id&quot;))
            .DataTable(&quot;T_DOC_CATALOG&quot;, &quot;DC&quot;, &quot;D&quot;, x =&gt; x.Link(&quot;D&quot;, &quot;doc_id&quot;))
            .DataTable(&quot;T_DOC_SCAN&quot;, &quot;SC&quot;, &quot;D&quot;, x =&gt; x.Link(&quot;D&quot;, &quot;doc_id&quot;)
                .SetOperation(FilterOperation.OuterJoin))
            .DataTable(&quot;T_DOC_SOURCE&quot;, &quot;SR&quot;, &quot;D&quot;, x =&gt; x.Link(&quot;D&quot;, &quot;doc_id&quot;)
                .SetOperation(FilterOperation.OuterJoin))
            .DataTable(&quot;T_DOC_DELIVERY&quot;, &quot;DD&quot;, &quot;D&quot;, x =&gt; x.Link(&quot;D&quot;, &quot;doc_id&quot;))
            .ReadOnlyProperty(x =&gt; x.DocId, x =&gt; x.Field&lt;long&gt;(&quot;D&quot;, string.Empty, 
                z =&gt; z.Key(), 
                z =&gt; z.Default(DefaultType.AutoIncrement)))
            .Column(&quot;DocStateId&quot;, x =&gt; x.Field&lt;long&gt;(&quot;S&quot;, string.Empty))
            .ReadOnlyProperty(x =&gt; x.DocStateCode, x =&gt; x.Field&lt;string&gt;(&quot;S&quot;, &quot;code&quot;))
            .ReadOnlyProperty(x =&gt; x.Generation, x =&gt; x.Field&lt;Guid&gt;(&quot;D&quot;, string.Empty, 
                z =&gt; z.ConcurrencyToken(), z =&gt; z.Default(DefaultType.NewGuid)))
            .ReadOnlyProperty(x =&gt; x.Changed, x =&gt; x.Field&lt;DateTime&gt;(&quot;D&quot;, string.Empty, 
                z =&gt; z.Default(DefaultType.CurrentDateTime, DefaultFeature.UseOnUpdate)))
            .Map(x =&gt; new Invoice {
                DocCatalogId =&gt; x.Field&lt;long&gt;(&quot;DC&quot;, &quot;catalog_id&quot;),
                DocState = x.Link&lt;string, DocState&gt;(&quot;S&quot;, &quot;name&quot;,
                    z =&gt; z.LinkProperty&lt;DocState&gt;(y =&gt; y.Name),
                    z =&gt; z.LinkProperty&lt;DocState&gt;((Invoice y) =&gt; y.DocStateId),
                    z =&gt; z.LinkProperty&lt;DocState&gt;(y =&gt; y.Code, y =&gt; y.DocStateCode)),
                Numb = x.Field&lt;string&gt;(&quot;D&quot;, string.Empty),
                DocDate = x.Field&lt;DateTime?&gt;(&quot;D&quot;, string.Empty, 
                    z =&gt; z.Default(DefaultType.CurrentDate)),
                Scan = x.Lob(&quot;SC&quot;, z =&gt; z.OuterFlag()),
                Source = x.Xml(&quot;SR&quot;, z =&gt; z.OuterFlag()),
                DeliveryType = x.Field&lt;DeliveryTypeEnum&gt;(&quot;DD&quot;, string.Empty),
                DeliveryDate = x.Field&lt;DateTime&gt;(&quot;DD&quot;, string.Empty, 
                    z =&gt; z.Default(DefaultType.CurrentDate))
            }).SetBaseTable(&quot;D&quot;)
    );
}
</code></pre><p>4) The first unfamiliar thing for us is <a class="xref" href="../../api/XData.Mapping.Dynamic.IInnerFilterAdapter.html#XData_Mapping_Dynamic_IInnerFilterAdapter_DictFilter_System_String_System_String_System_String_System_String_">DictFilter</a>. This method allows you to filter the data object by reference to the dictionary in which there is a unique string field <em>Code</em> with which we can not rely on the dictionary identifiers at the level of mapping and business logic. In fact, it degenerates into a filter on a subquery (in our case it will be <em>D.doc_type_id = (select doc_type_id from T_DOC_TYPE where code = &#39;INVOICE&#39;)</em>). See <a href="../../tutorial/mapping/dynamic/dynamic.html#dictionary-filters">documentation topic</a> for more details</p>
<p>5) A not very noticeable, but extremely important detail is that for some tables a new overload of the <a class="xref" href="../../api/XData.Mapping.Dynamic.IRepositoryStructure-1.html#XData_Mapping_Dynamic_IRepositoryStructure_1_DataTable_System_String_System_String_System_String_System_Linq_Expressions_Expression_System_Func_XData_Mapping_Dynamic_IInnerFilterAdapter_XData_Mapping_Dynamic_IFilterDescription_____">DataTable</a> method is used with the <em>parent</em> parameter, which defines the alias of the parent table in <a href="../../tutorial/glossary.html#updatable-tables-hierarchy">updatable tables hierarchy</a>. The introduction of this concept allows applying the change not to one table, but to any number of tables in which information about an instance of a data object is stored.</p>
<div class="IMPORTANT"><h5>Important</h5><p>Do not forget to specify the parent table in the <em>updatable table tree</em> for those tables that should be updated when the data object changes. At the same time, tables containing reference information are not included in the <em>updatable table tree</em> and do not participate in the update process. For such tables, an overload of the <em>DataTable</em> method is used, which we used earlier.</p>
</div>
<p>6) The next interesting thing is the <a class="xref" href="../../api/XData.Mapping.Dynamic.IRepositoryReadOnlyPropertyMappingAdapter.html#XData_Mapping_Dynamic_IRepositoryReadOnlyPropertyMappingAdapter_ConcurrencyToken">ConcurrencyToken</a> modifier, which is responsible for <a href="https://en.wikipedia.org/wiki/Optimistic_concurrency_control">optimistic lock</a> support. This modifier works in tandem with the familiar <em>Default</em> modifier, which is initialized with the <a class="xref" href="../../api/XData.DefaultType.html">DefaultType.NewGuid</a> value, which means generating a new unique key (GUID). See <a href="../../tutorial/mapping/dynamic/dynamic.html#properties">documentation topic</a> for more details</p>
<div class="TIP"><h5>Tip</h5><p>Note that the competition token is described in mapping and does not require any other code! It can even be mapped into a read-only field (as in this case).</p>
</div>
<p>7) The next interesting detail is the automatic completion of the <em>Changed</em> property by change date. Using the <em>Default</em> modifier with two parameters, the first <a class="xref" href="../../api/XData.DefaultType.html">DefaultType.CurrentDateTime</a> sets the mechanism for obtaining the default field value by storing the date and time of the change in the local time zone, and the second <a class="xref" href="../../api/XData.DefaultFeature.html">DefaultFeature.UseOnUpdate</a> allows you to save the change time not only during insertion but also during update. See <a href="../../tips/default_features.html">documentation topic</a> for more details</p>
<p>8) The <em>DocDate</em> and <em>DeliveryDate</em> properties are modified with the default value <a class="xref" href="../../api/XData.DefaultType.html">DefaultType.CurrentDate</a> which means that by default, the current date will be written to these properties.</p>
<p>9) The <em>Scan</em> property has a specific type of <a class="xref" href="../../api/XData.Mapping.Lob.html">Lob</a> and its mapping is described using the <a class="xref" href="../../api/XData.Mapping.Dynamic.IRepositoryStructureAdapter-1.html#XData_Mapping_Dynamic_IRepositoryStructureAdapter_1_Lob_System_String_System_Linq_Expressions_Expression_System_Func_XData_Mapping_Dynamic_IRepositoryReadOnlyPropertyMappingAdapter_XData_Mapping_Dynamic_IStructureFlag_____">Lob</a> method. Similarly, the <em>Source</em> property has a specific <a class="xref" href="../../api/XData.Mapping.Xml.html">Xml</a> type and its mapping is described using the <a class="xref" href="../../api/XData.Mapping.Dynamic.IRepositoryStructureAdapter-1.html#XData_Mapping_Dynamic_IRepositoryStructureAdapter_1_Xml_System_String_System_Linq_Expressions_Expression_System_Func_XData_Mapping_Dynamic_IRepositoryReadOnlyPropertyMappingAdapter_XData_Mapping_Dynamic_IStructureFlag_____">Xml</a> method. The work with these types is different, but it is important that by default the value of such fields is loaded only if the value of a large object is immediately addressed. There are also features when serializing them in JSON (we will consider this below). There are also features when serializing them in JSON (we will consider this below). This behavior allows you to significantly accelerate the work with objects that contain information in large fields. See documentation topic about <a href="../../tutorial/mapping/mapping.html#binary-properties">binary properties</a> and <a href="../../tutorial/mapping/mapping.html#xml-properties">Xml properties</a> for more details</p>
<p>10) Web API controller for this object will look like...</p>
<pre><code class="lang-csharp">using XData;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Mvc;
using &lt;..Youre namespace..&gt;.Models;

namespace &lt;..Youre namespace..&gt;.Controllers.API
{
    public class InvoiceController : DataObjectController&lt;Invoice&gt;
    {
        public InvoiceController(IDataEngine dataEngine) : base(dataEngine) { }

        [HttpGet]
        public async Task&lt;ActionResult&lt;Invoice&gt;&gt; Get(long id, CancellationToken cancellationToken)
        {
            try
            {
                using (var dataScope = _dataEngine.NewDataScope(cancellationToken))
                {
                    return await dataScope.GetRepository&lt;Invoice&gt;()
                        .SingleOrDefaultAsync(x =&gt; x.DocId == id);
                }
            }
            catch (Exception e)
            {
                e.FillModelState(ModelState);
                throw;
            }
        }

        [HttpGet]
        public async Task&lt;ActionResult&lt;Invoice[]&gt;&gt; GetByCatalog(long id, CancellationToken cancellationToken)
        {
            try
            {
                using (var dataScope = _dataEngine.NewDataScope(cancellationToken))
                {
                    return await dataScope.GetRepository&lt;Invoice&gt;()
                        .ToArrayAsync(x =&gt; x.CatalogId == id);
                }
            }
            catch (Exception e)
            {
                e.FillModelState(ModelState);
                throw;
            }
        }

        [HttpGet]
        public async Task&lt;ActionResult&lt;Invoice&gt;&gt; Export(long id, CancellationToken cancellationToken)
        {
            try
            {
                using (var dataScope = _dataEngine.NewDataScope(cancellationToken))
                {
                    return await dataScope.GetRepository&lt;Invoice&gt;()
                        .SingleOrDefaultAsync(x =&gt; x.DocId == id,
                            x =&gt; x.LoadLob());
                }
            }
            catch (Exception e)
            {
                e.FillModelState(ModelState);
                throw;
            }
        }

        [HttpGet]
        public async Task&lt;ActionResult&lt;byte[]&gt;&gt; GetScan(long id, CancellationToken cancellationToken)
        {
            try
            {
                using (var dataScope = _dataEngine.NewDataScope(cancellationToken))
                {
                    return await dataScope.GetRepository&lt;Invoice&gt;()
                        .Where(x =&gt; x.DocId == id)
                        .Scan.Value;
                }
            }
            catch (Exception e)
            {
                e.FillModelState(ModelState);
                throw;
            }
        }

        [HttpPut]
        public async Task&lt;ActionResult&lt;Invoice[]&gt;&gt; FindBySource([FromBody]string xpath, string value, CancellationToken cancellationToken)
        {
            try
            {
                using (var dataScope = _dataEngine.NewDataScope(cancellationToken))
                {
                    return await dataScope.GetRepository&lt;Invoice&gt;()
                        .Where(x =&gt; x.Source.Extract(xpath) == value)
                        .ToArrayAsync();
                }
            }
            catch (Exception e)
            {
                e.FillModelState(ModelState);
                throw;
            }
        }
    }
}
</code></pre><p>11) The <em>Export</em> method shows how you can get an object with large fields filled. This is available due to the use of the <a class="xref" href="../../api/XData.Json.JsonSettings-1.html#XData_Json_JsonSettings_1_LoadLob">LoadLob</a> modifier. Most asynchronous XData methods have overloads to describe serialization parameters. For a complete description, refer to the corresponding <a href="../../tips/json.html">documentation article</a>.</p>
<p>12) Getting the value of a binary object is shown in the <em>GetScan</em> method. To get the value, use the <a class="xref" href="../../api/XData.Mapping.Lob.html#XData_Mapping_Lob_Value">Value</a> property of the <em>Lob</em> object.</p>
<p>13) The <em>Xml</em> type is interesting, among other things, because its contents can be used to construct XPath queries and use them to filter data. To do this, use the <a class="xref" href="../../api/XData.Mapping.Xml.html#XData_Mapping_Xml_Extract_System_String_System_Collections_Generic_KeyValuePair_System_String_System_String____">Extract</a> method of type <em>Xml</em> as shown in the <em>FindBySource</em> method.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/mickfierte/private/blob/main/doc/quick_start/asp_net_core/mapping_three.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
